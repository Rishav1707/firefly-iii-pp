<mat-progress-bar color="accent" *ngIf="busy" mode="indeterminate"></mat-progress-bar>
<div class="progress-bar-gap" *ngIf="!busy"></div>
<div class="content-container">
    <div class="content">
        <mat-accordion class="pp-accordion" multi>
            <mat-expansion-panel>
                <mat-expansion-panel-header>
                    <mat-panel-title class="accordion-panel-title">
                        <mat-spinner *ngIf="status && status.state === 'running'" diameter="25" color="accent" class="test-spinner"></mat-spinner>
                        Status
                    </mat-panel-title>
                    <mat-panel-description>
                        Manage running job
                    </mat-panel-description>
                </mat-expansion-panel-header>
                <div class="pp-accordion-content">
                    <div class="pp-accordion-content-row">
                        <mat-progress-bar *ngIf="status?.state === 'running'" mode="determinate" [value]="getProgress()"></mat-progress-bar>
                    </div>
                    <div class="pp-accordion-content-row">
                        <button color="primary" (click)="refreshStatus()" mat-raised-button>Refresh Status</button>
                        <button color="warn" (click)="stopJob()" mat-raised-button>Stop Job</button>
                    </div>
                    <div *ngIf="status" class="pp-accordion-content-row">
                        <table class="status-table">
                            <tr><td>State:</td><td class="state-attribute"
                                [class.state-completed]="status.state === 'completed'"
                                [class.state-failed]="status.state === 'failed'"
                                [class.state-stopped]="status.state === 'stopped'"
                                [class.state-running]="status.state === 'running'">
                                <span>{{ status.state }}</span>
                            </td></tr>
                            <tr><td>Current page:</td><td class="state-attribute">
                                <span>{{ status.currentPage }}</span>
                            </td></tr>
                            <tr><td>Total pages:</td><td class="state-attribute">
                                <span>{{ status.totalPages }}</span>
                            </td></tr>
                            <tr><td>Completed transactions:</td><td class="state-attribute">
                                <span>{{ status.completedTransactions }}</span>
                            </td></tr>
                            <tr><td>Total transactions:</td><td class="state-attribute">
                                <span>{{ status.totalTransactions }}</span>
                            </td></tr>
                        </table>
                    </div>
                </div>
            </mat-expansion-panel>
            <mat-expansion-panel>
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        Configure
                    </mat-panel-title>
                    <mat-panel-description>
                        Set options for next job
                    </mat-panel-description>
                </mat-expansion-panel-header>
                <div class="pp-accordion-content">
                    ahhh bees
                    <mat-divider></mat-divider>
                    AHHHH BEEES
                </div>
            </mat-expansion-panel>
            <mat-expansion-panel>
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        Run
                    </mat-panel-title>
                    <mat-panel-description>
                        Start or dry run a new job
                    </mat-panel-description>
                </mat-expansion-panel-header>
                <div class="pp-accordion-content">
                    ahhh bees
                    <mat-divider></mat-divider>
                    AHHHH BEEES
                </div>
            </mat-expansion-panel>
        </mat-accordion>
    </div>
</div>